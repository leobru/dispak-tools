# dispak-tools
Various tools for OS DISPAK for BESM-6, disassembled/decompiled.

## MARK3
Утилита для разметки лент ЕС ЭВМ на СВС (Э1-К2) путем прямого доступа к ПВВ.
Для компиляции требуется улучшенный Паскаль-компилятор.

## Паскаль-компилятор

### По сравнению с базовой версией компилятора в составе МС "Дубна" или "Монитор-80", внесены следующие изменения, повторяющие изменения в компиляторе, использовавшемся для разработки кросс-системы программирования Э1-КБ:

 - неиспользуемые байты в строковых константах - нулевые (а не пробелы в коде ISO).
 - исправлена ошибка, вызывающая добавление лишнего слова, если длина строковой константы кратна 6 байтам.
 - избегается избыточная команда чтения сразу после записи (исключая, разумеется, магазинную запись) по тому же адресу
   в том же линейном участке.
 - реализована конструкция `besm(константа : L-выражение)`, позволяющая ссылаться на переменные и элементы массивов или структур во вставках машинного кода. Например, оператор
   `besm(0 : L-выражение);` эквивалентен оператору `L-выражение := ;` (присваивание сумматора).
 - реализовано номинальное преобразование типов R-выражений с помощью конструкции `тип(выражение)`. Первоначальный тип выражения должен быть однословным.
 - реализовано указание абсолютных адресов для переменных с помощью конструкции `var переменная [ адрес ] : тип;` 

### Известные, но пока не реализованные изменения:

 - код для инициализации переменных типа файл вставляется не в самое начало объектного модуля, а непосредственно перед началом главной программы.
 - обрамление строковых констант двойными кавычками означает выбор альтернативной (какой?) кодировки.
 - запись нескольких машинных команд в `besm` через запятую.
